# {{ api_name }}

## 개요

{{ description }}

## API 정보

| 항목 | 내용 |
|--------|--------|
| **API 명** | {{ api_name }} |
| **API ID** | {{ api_id }} |
| **HTTP Method** | {{ http_method }} |
| **URL** | {{ url }} |
| **Domain (실전)** | https://openapi.koreainvestment.com:9443 |
| **Domain (모의)** | https://openapivts.koreainvestment.com:29443 |
{% if real_tr_id %}
| **실전 TR_ID** | `{{ real_tr_id }}` |
{% endif %}
{% if paper_tr_id %}
| **모의 TR_ID** | `{{ paper_tr_id }}` |
{% else %}
| **모의 TR_ID** | 미지원 |
{% endif %}
{% if hashkey_required %}
| **Hashkey 필요** | {{ hashkey_required }} |
{% endif %}

{% if unsupported_paper_trading %}
> **⚠️ 주의:** 이 API는 모의투자에서 지원되지 않습니다.
{% endif %}

## 설명

{{ detailed_description }}

## Request Header

| Element | 한글명 | Type | Required | Description |
|----------|----------|-------|-----------|-------------|
| content-type | 컨텐츠타입 | string | Y | application/json; charset=utf-8 |
| appkey | 앱키 | string | Y | 한국투자증권 홈페이지에서 발급받은 appkey |
| appsecret | 앱시크릿키 | string | Y | 한국투자증권 홈페이지에서 발급받은 appsecret |
| authorization | 접근토큰 | string | Y | Bearer {access_token} |
{% if real_tr_id %}
| tr_id | TR_ID | string | Y | `{{ real_tr_id }}` (실전) |
{% endif %}
{% if paper_tr_id %}
| | | | | `{{ paper_tr_id }}` (모의) |
{% endif %}
{% if hashkey_required %}
| hashkey | 해시키 | string | N | POST 요청 시 본문 해시값 (보안 강화용) |
{% endif %}

{% if request_parameters %}
## Request Parameters

{% for param in request_parameters %}
| {{ param.name }} | {{ param.korean_name }} | {{ param.type }} | {{ param.required }} | {{ param.description }} |
{% endfor %}
{% endif %}

{% if request_body_example %}
## Request Body Example

```json
{{ request_body_example }}
```
{% endif %}

{% if response_fields %}
## Response Fields

{% for field in response_fields %}
| {{ field.name }} | {{ field.korean_name }} | {{ field.type }} | {{ field.description }} |
{% endfor %}
{% endif %}

{% if response_example %}
## Response Example

```json
{{ response_example }}
```
{% endif %}

## Python 코드 예시

```python
import requests
{% if hashkey_required %}
import hashlib

def get_hashkey(appkey, appsecret, request_body):
    """해시키 발급"""
    url = "https://openapi.koreainvestment.com:9443/uapi/hashkey"
    headers = {
        "Content-Type": "application/json; charset=utf-8",
        "appkey": appkey,
        "appsecret": appsecret
    }

    response = requests.post(url, headers=headers, json=request_body)

    if response.status_code == 200:
        return response.json()["HASH"]
    else:
        raise Exception(f"해시키 발급 실패: {response.status_code}")

{% endif %}
def {{ function_name }}(access_token, appkey, appsecret{% for param in required_params %}, {{ param.name }}{% endfor %}):
    """
    {{ api_description }}

    Args:
        access_token: 접근 토큰
        appkey: 앱키
        appsecret: 앱시크릿키
{% for param in required_params %}
        {{ param.name }}: {{ param.description }}
{% endfor %}

    Returns:
        dict: API 응답 결과
    """
    url = "{{ full_url }}"

{% if request_body_build %}
    # 요청 본문 구성
    request_body = {
{% for line in request_body_build %}
        {{ line }}
{% endfor %}
    }

    # 해시키 생성
    hashkey = get_hashkey(appkey, appsecret, request_body)

    headers = {
        "Authorization": f"Bearer {access_token}",
        "appkey": appkey,
        "appsecret": appsecret,
        "Content-Type": "application/json; charset=utf-8",
        "tr_id": "{{ real_tr_id }}"{% if hashkey_required %},
        "hashkey": hashkey
    }
{% else %}
    headers = {
        "Authorization": f"Bearer {access_token}",
        "appkey": appkey,
        "appsecret": appsecret,
        "Content-Type": "application/json; charset=utf-8",
        "tr_id": "{{ real_tr_id }}"
    }
{% endif %}

{% if http_method == "GET" %}
    params = {
{% for param in query_params %}
        "{{ param.name }}": {{ param.name }},
{% endfor %}
    }

    response = requests.get(url, headers=headers, params=params)
{% else %}
    {% if request_body_build %}
    response = requests.post(url, headers=headers, json=request_body)
    {% else %}
    response = requests.post(url, headers=headers)
    {% endif %}
{% endif %}

    if response.status_code == 200:
        return response.json()
    else:
        raise Exception(f"API 요청 실패: {response.status_code}, {response.text}")

# 사용 예시
appkey = "PSg5dctL9dKPo727J13Ur405OSXXXXXXXXXX"
appsecret = "yo2t8zS68zpdjGuWvFyM9VikjXE0i0CbgPEamnqPA00G0bIfrdfQb2RUD1xP7SqatQXr1cD1fGUNsb78MMXoq6o4lAYt9YTtHAjbMoFy+c72kbq5owQY1Pvp39/x6ejpJlXCj7gE3yVOB/h25Hvl+URmYeBTfrQeOqIAOYc/OIXXXXXXXXXX"

# 접근 토큰 발급
token_response = requests.post(
    "https://openapi.koreainvestment.com:9443/oauth2/tokenP",
    headers={"Content-Type": "application/json"},
    json={
        "grant_type": "client_credentials",
        "appkey": appkey,
        "appsecret": appsecret
    }
)
access_token = token_response.json()["access_token"]

# API 호출
{% if call_example %}
{{ call_example }}
{% else %}
result = {{ function_name }}(
    access_token,
    appkey,
    appsecret
    {% for param in required_params %}
    ,
    {{ param.name }}="{{ param.value }}"
    {% endfor %}
)

print(result)
{% endif %}
```

## 참고사항

{% for note in notes %}
- {{ note }}
{% endfor %}

## 관련 API

{% for related_api in related_apis %}
- [{{ related_api.name }}](../{{ related_api.category }}/{{ related_api.file }})
{% endfor %}

## 변경 이력

| 날짜 | 변경 내용 |
|------|----------|
| {{ initial_date }} | 초기 문서 작성 |
